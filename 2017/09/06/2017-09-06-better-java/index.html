<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Better Java, 张曙 自由、快乐、充实">
    <meta name="description" content="Better JavaJava 虽作为最流行的编程语言之一，但是似乎并没有什么人很享受用它。好吧，Java 确实是这样的一门编程语言，从最近发布不久的 Java 8 开始，为了更好的使用 Java，我决定收集一些库，实践和工具等相关资料。“">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Better Java | 快乐时光</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    
    <script src="/libs/jquery/jquery.min.js"></script>
    
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper head-container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">快乐时光</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fas fa-list" style="zoom: 0.6;"></i>
      
      <span>爱好</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/musics">
          
          <i class="fas fa-music" style="margin-top: -20px; zoom: 0.6;"></i>
          

          <span>音乐</span>

        </a>
      </li>
      
      <li>
        <a href="/movies">
          
          <i class="fas fa-film" style="margin-top: -20px; zoom: 0.6;"></i>
          

          <span>视频</span>

        </a>
      </li>
      
      <li>
        <a href="/books">
          
          <i class="fas fa-book" style="margin-top: -20px; zoom: 0.6;"></i>
          

          <span>书籍</span>

        </a>
      </li>
      
      <li>
        <a href="/galleries">
          
          <i class="fas fa-image" style="margin-top: -20px; zoom: 0.6;"></i>
          

          <span>相册</span>

        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">快乐时光</div>
        <div class="logo-desc">
            
            探索未知，享受快乐，记录美好时光!
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			Contact
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-list"></i>
			
			爱好
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>   
				
                  <a href="/musics " style="margin-left:75px";>
				  
				   <i class="fa fas fa-music" style="position: absolute;left:50px" ></i>
			      
                      <span>音乐</span>

                  </a>
                </li>
              
                <li>   
				
                  <a href="/movies " style="margin-left:75px";>
				  
				   <i class="fa fas fa-film" style="position: absolute;left:50px" ></i>
			      
                      <span>视频</span>

                  </a>
                </li>
              
                <li>   
				
                  <a href="/books " style="margin-left:75px";>
				  
				   <i class="fa fas fa-book" style="position: absolute;left:50px" ></i>
			      
                      <span>书籍</span>

                  </a>
                </li>
              
                <li>   
				
                  <a href="/galleries " style="margin-left:75px";>
				  
				   <i class="fa fas fa-image" style="position: absolute;left:50px" ></i>
			      
                      <span>相册</span>

                  </a>
                </li>
               
            </ul>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/findhappytime/findhappytime.github.io" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>

        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/findhappytime/findhappytime.github.io" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/10.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        Better Java
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="container content">

    
    <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/%E7%AC%94%E8%AE%B0/">
                                <span class="chip bg-color">笔记</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E4%B9%A6%E7%B1%8D/" class="post-category">
                                书籍
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2017-09-06
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    7.1k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    26 分
                </div>
                
				
                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
            
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="Better-Java"><a href="#Better-Java" class="headerlink" title="Better Java"></a>Better Java</h1><p>Java 虽作为最流行的编程语言之一，但是似乎并没有什么人很享受用它。好吧，Java 确实是这样的一门编程语言，从最近发布不久的 Java 8 开始，为了更好的使用 Java，我决定收集一些库，实践和工具等相关资料。“更好” 是主观的，所以推荐使用我所说的建议的某些部分，而不是一下子全部按照这些建议来做。请尽情添加其他意见并提交 PR。</p>
<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ul>
<li><a href="#style">Style（风格）</a><ul>
<li><a href="#structs">Structs（结构）</a><ul>
<li><a href="#the-builder-pattern">The Builder Pattern（构建器模式）</a></li>
<li><a href="#immutable-object-generation">Immutable Object Generation（不可变对象生成）</a></li>
</ul>
</li>
<li><a href="#exceptions">Exceptions（异常）</a></li>
<li><a href="#dependency-injection">Dependency injection（依赖注入）</a></li>
<li><a href="#avoid-nulls">Avoid Nulls（避免空值）</a></li>
<li><a href="#immutable-by-default">Immutable-by-default（默认不可变）</a></li>
<li><a href="#avoid-lots-of-util-classes">Avoid lots of Util classes（避免过多的工具类）</a></li>
<li><a href="#formatting">Formatting（格式）</a><ul>
<li><a href="#javadoc">Javadoc</a></li>
</ul>
</li>
<li><a href="#streams">Streams（流）</a></li>
</ul>
</li>
<li><a href="#deploying">Deploying（部署）</a><ul>
<li><a href="#frameworks">Frameworks（框架）</a></li>
<li><a href="#maven">Maven</a><ul>
<li><a href="#dependency-convergence">Dependency Convergence（依赖收敛）</a></li>
</ul>
</li>
<li><a href="#continuous-integration">Continuous Integration（持续集成）</a></li>
<li><a href="#maven-repository">Maven repository（Maven 仓库）</a></li>
<li><a href="#configuration-management">Configuration management（配置管理）</a></li>
</ul>
</li>
<li><a href="#libraries">Libraries（库）</a><ul>
<li><a href="#missing-features">Missing Features（缺失的特性）</a><ul>
<li><a href="#apache-commons">Apache Commons</a></li>
<li><a href="#guava">Guava</a></li>
<li><a href="#gson">Gson</a></li>
<li><a href="#java-tuples">Java Tuples（Java 元组）</a></li>
<li><a href="#javaslang">Javaslang</a></li>
<li><a href="#joda-time">Joda-Time</a></li>
<li><a href="#lombok">Lombok</a></li>
<li><a href="#play-framework">Play framework（Play 框架）</a></li>
<li><a href="#slf4j">SLF4J</a></li>
<li><a href="#jooq">jOOQ</a></li>
</ul>
</li>
<li><a href="#testing">Testing（测试）</a><ul>
<li><a href="#junit-4">jUnit 4</a></li>
<li><a href="#jmock">jMock</a></li>
<li><a href="#assertj">AssertJ</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#tools">Tools（工具）</a><ul>
<li><a href="#intellij-idea">IntelliJ IDEA</a><ul>
<li><a href="#chronon">Chronon</a></li>
</ul>
</li>
<li><a href="#jrebel">JRebel</a></li>
<li><a href="#the-checker-framework">The Checker Framework（检查框架）</a></li>
<li><a href="#code-quality">Code Quality（代码质量）</a></li>
<li><a href="#eclipse-memory-analyzer">Eclipse Memory Analyzer（Eclipse 内存分析）</a></li>
</ul>
</li>
<li><a href="#resources">Resources（资源）</a><ul>
<li><a href="#books">Books（书）</a></li>
<li><a href="#podcasts">Podcasts（播客）</a></li>
<li><a href="#videos">Videos（视频）</a></li>
</ul>
</li>
</ul>
<h2 id="Style"><a href="#Style" class="headerlink" title="Style"></a>Style</h2><p>Java 传统的代码风格是被用来编写非常复杂的企业级 JavaBean。新的代码风格看起来会更加整洁，更加正确，并且更加简单。</p>
<h3 id="Structs"><a href="#Structs" class="headerlink" title="Structs"></a>Structs</h3><p>对我们程序员来说，包装数据是最简单的事情之一。下面是传统的通过定义一个 JavaBean 的实现方式：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataHolder</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> String data<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">DataHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setData</span><span class="token punctuation">(</span>String data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> String <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>这种方式既繁琐又浪费代码。即使你的 IDE 可以自动生成这些代码，也是浪费。因此，<a href="http://www.javapractices.com/topic/TopicAction.do?Id=84" target="_blank" rel="noopener">别这么干</a>.</p>
<p>相反，我更喜欢 C 语言保存数据的风格来写一个类：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataHolder</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> String data<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">DataHolder</span><span class="token punctuation">(</span>String data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>这样不仅减少了近一半的代码行数。并且，这个类里面保存的数据除了你去继承它，否则不会改变，由于它不可变性，我们可以认为这会更加简单。</p>
<p>如果你想保存很容易修改的对象数据，像 Map 或者 List，你应该使用 ImmutableMap 或者 ImmutableList，这些会在不变性那一部分讨论。</p>
<h4 id="The-Builder-Pattern"><a href="#The-Builder-Pattern" class="headerlink" title="The Builder Pattern"></a>The Builder Pattern</h4><p>如果你想用这种构造的方式构造更复杂的对象，请考虑构建器模式。</p>
<p>你可以建一个静态内部类来构建你的对象。构建器构建对象的时候，对象的状态是可变的，但是一旦你调用了 build 方法之后，构建的对象就变成了不可变的了。</p>
<p>想象一下我们有一个更复杂的 <em>DataHolder</em>。那么它的构建器看起来应该是这样的：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ComplicatedDataHolder</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> String data<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> num<span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// lots more fields and a constructor</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Builder</span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> String data<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> num<span class="token punctuation">;</span>

        <span class="token keyword">public</span> Builder <span class="token function">data</span><span class="token punctuation">(</span>String data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> data<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> Builder <span class="token function">num</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">=</span> num<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> ComplicatedDataHolder <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ComplicatedDataHolder</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// etc</span>
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>然后调用它：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">final</span> ComplicatedDataHolder cdh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ComplicatedDataHolder<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token string">"set this"</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">num</span><span class="token punctuation">(</span><span class="token number">523</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>这有<a href="http://jlordiales.me/2012/12/13/the-builder-pattern-in-practice/" target="_blank" rel="noopener">关于构建器更好的例子</a>，他会让你感受到构建器到底是怎么回事。它没有使用许多我们尽力避免使用的样板，并且它会给你不可变的对象和非常好用的接口。</p>
<p>可以考虑下在众多的库中选择一个来帮你生成构建器，取代你亲手去写构建器的方式。</p>
<h4 id="Immutable-Object-Generation"><a href="#Immutable-Object-Generation" class="headerlink" title="Immutable Object Generation"></a>Immutable Object Generation</h4><p>如果你要手动创建许多不可变对象，请考虑用注解处理器的方式从它们的接口自动生成。它使样板代码减少到最小化，减少产生 bug 的可能性，促进了对象的不可变性。看这 <a href="https://docs.google.com/presentation/d/14u_h-lMn7f1rXE1nDiLX0azS3IkgjGl5uxp5jGJ75RE/edit#slide=id.g2a5e9c4a8_00" target="_blank" rel="noopener">presentation</a> 有常见的 Java 设计模式中一些问题的有趣的讨论。</p>
<p>一些非常棒的代码生成库如 [immutables]<br>(<a href="https://github.com/immutables/immutables" target="_blank" rel="noopener">https://github.com/immutables/immutables</a>), 谷歌的<br><a href="https://github.com/google/auto/tree/master/value" target="_blank" rel="noopener">auto-value</a> 和<br><a href="https://projectlombok.org/" target="_blank" rel="noopener">Lombok</a></p>
<h3 id="Exceptions"><a href="#Exceptions" class="headerlink" title="Exceptions"></a>Exceptions</h3><p>使用<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Exception.html" target="_blank" rel="noopener">检查</a>异常的时候一定要注意，或者干脆别用。它会强制你去用 try/catch 代码块包裹住可能抛出异常的部分。比较好的方式就是使你自定义的异常继承自运行时异常来取而代之。这样，可以让你的用户使用他们喜欢的方式去处理异常，而不是每次抛出异常的时候都强制它们去处理/声明，这样会污染代码。</p>
<p>一个比较漂亮的绝招是在你的方法异常声明中声明 RuntimeExceptions。这对编译器没有影响，但是可以通过文档告诉你的用户在这里可能会有异常抛出。</p>
<h3 id="Dependency-injection"><a href="#Dependency-injection" class="headerlink" title="Dependency injection"></a>Dependency injection</h3><p>在软件工程领域，而不仅是在 Java 领域，使用<a href="https://en.wikipedia.org/wiki/Dependency_injection" target="_blank" rel="noopener">依赖注入</a>是编写可测试软件最好的方法之一。<br>由于 Java 强烈鼓励使用面向对象的设计，所以在 Java 中为了开发可测试软件，你不得不使用依赖注入。</p>
<p>在 Java 中，通常使用<a href="http://projects.spring.io/spring-framework/" target="_blank" rel="noopener">Spring 框架</a>来完成依赖注入。Spring 有基于代码的和基于 XML 配置文件的两种连接方式。如果你使用基于 XML 配置文件的方式，注意不要<a href="http://programmers.stackexchange.com/questions/92393/what-does-the-spring-framework-do-should-i-use-it-why-or-why-not" target="_blank" rel="noopener">过度使用 Spring</a>，正是由于它使用的基于 XML 配置文件的格式。在 XML 配置文件中绝对不应该有逻辑或者控制结构。它应该仅仅被用来做依赖注入。</p>
<p>使用 Google 和 Square 的 <a href="http://square.github.io/dagger/" target="_blank" rel="noopener">Dagger</a> 或者 Google 的 <a href="https://github.com/google/guice" target="_blank" rel="noopener">Guice</a> 库是 Spring 比较好的替代品。它们不使用像 Spring 那样的 XML 配置文件的格式，相反它们把注入逻辑以注解的方式写到代码中。</p>
<h3 id="Avoid-Nulls"><a href="#Avoid-Nulls" class="headerlink" title="Avoid Nulls"></a>Avoid Nulls</h3><p>尽量避免使用空值。不要返回 null 的集合，你应该返回一个 empty 的集合。如果你确实准备使用 null 请考虑使用 <a href="https://github.com/google/guice/wiki/UseNullable" target="_blank" rel="noopener">@Nullable</a> 注解。<a href="http://www.jetbrains.com/idea/" target="_blank" rel="noopener">IntelliJ IDEA</a> 内置支持 @Nullable 注解。</p>
<p>阅读<a href="https://www.lucidchart.com/techblog/2015/08/31/the-worst-mistake-of-computer-science/" target="_blank" rel="noopener">计算机科学领域最糟糕的错误</a>了解更多为何不使用 null。</p>
<p>如果你使用的是 Java 8，你可以用新出的优秀的 <a href="http://www.oracle.com/technetwork/articles/java/java8-optional-2175753.html" target="_blank" rel="noopener">Optional</a> 类型。如果有一个值你不确定是否存在，你可以像这样在类中用 <em>Optional</em> 包裹住它们：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FooWidget</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> String data<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> Optional<span class="token operator">&lt;</span>Bar<span class="token operator">></span> bar<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">FooWidget</span><span class="token punctuation">(</span>String data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> Optional<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">FooWidget</span><span class="token punctuation">(</span>String data<span class="token punctuation">,</span> Optional<span class="token operator">&lt;</span>Bar<span class="token operator">></span> bar<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> data<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>bar <span class="token operator">=</span> bar<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> Optional<span class="token operator">&lt;</span>Bar<span class="token operator">></span> <span class="token function">getBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> bar<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>这样，现在你可以清晰地知道 <em>data</em> 肯定不为 null，但是 <em>bar</em> 不清楚是不是存在。<em>Optional</em> 有如 <em>isPresent</em> 这样的方法，可以用来检查是否为 <em>null</em>，感觉和原来的方式并没有太大区别。但是它允许你可以这样写：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">final</span> Optional<span class="token operator">&lt;</span>FooWidget<span class="token operator">></span> fooWidget <span class="token operator">=</span> <span class="token function">maybeGetFooWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">final</span> Baz baz <span class="token operator">=</span> fooWidget<span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span>FooWidget<span class="token operator">:</span><span class="token operator">:</span>getBar<span class="token punctuation">)</span>
                         <span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span>BarWidget<span class="token operator">:</span><span class="token operator">:</span>getBaz<span class="token punctuation">)</span>
                         <span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span>defaultBaz<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>这样比写一连串的判断是否为空的检查代码更好。使用 Optional 唯一不好的是标准库对 Optional 的支持并不是很好，所以对 null 的处理仍然是必要的。</p>
<h3 id="Immutable-by-default"><a href="#Immutable-by-default" class="headerlink" title="Immutable-by-default"></a>Immutable-by-default</h3><p>变量，类和集合应该设置为不可变的，除非你有很好的理由去修改他们。</p>
<p>变量可以用 <em>final</em> 关键字使起不可变：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">final</span> FooWidget fooWidget<span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">condition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fooWidget <span class="token operator">=</span> <span class="token function">getWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        fooWidget <span class="token operator">=</span> cachedFooWidget<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">CachingException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"Couldn't get cached value"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">// fooWidget is guaranteed to be set here</span></code></pre>
<p>现在你可以确定 fooWidget 对象不会意外地被重新赋值了。<em>final</em> 关键词也可以在 if/else 和 try/catch 代码块中使用。当然，如果 <em>fooWidget</em> 对象本身不是不可变的，你可以很容易去修改它。</p>
<p>使用集合的时候，任何可能的情况下尽量使用 Guava 的 <a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/ImmutableMap.html" target="_blank" rel="noopener">ImmutableMap</a>, <a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/ImmutableList.html" target="_blank" rel="noopener">ImmutableList</a>, 或者<br><a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/ImmutableSet.html" target="_blank" rel="noopener">ImmutableSet</a> 类。这些类都有构建器，你可以很容易地动态构建集合，一旦你执行了 build 方法，集合就变成了不可变的。</p>
<p>类应该声明不可变的字段（通过 <em>final</em> 实现）和不可变的集合使该类不可变。或者，可以对类本身使用 <em>final</em> 关键词，这样这个类就不会被继承也不会被修改了。</p>
<h3 id="Avoid-lots-of-Util-classes"><a href="#Avoid-lots-of-Util-classes" class="headerlink" title="Avoid lots of Util classes"></a>Avoid lots of Util classes</h3><p>如果你发现在你正在往工具类中添加很多方法，就要注意了。</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MiscUtil</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> String <span class="token function">frobnicateString</span><span class="token punctuation">(</span>String base<span class="token punctuation">,</span> <span class="token keyword">int</span> times<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// ... etc</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">throwIfCondition</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> condition<span class="token punctuation">,</span> String msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// ... etc</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>乍一看这些工具类似乎很不错，因为里面的那些方法放在别处确实都不太合适。因此，你以可重用代码的名义全放这了。</p>
<p>这个想法比本身这么做还要糟糕。请把这些类放到它应该在的地方去并积极重构。不要命名一些像 “MiscUtils” 或者 “ExtrasLibrary” 这样的很普通的类，包或者库。这会鼓励产生无关代码。</p>
<h3 id="Formatting"><a href="#Formatting" class="headerlink" title="Formatting"></a>Formatting</h3><p>格式化代码对大多数程序员来说并没有它应有的那么重要。统一化你的代码格式对阅读你的代码的人有帮助吗？当然了。但是别在为了 if 代码块匹配添加空格上耗一天。</p>
<p>如果你确实需要一个代码格式风格的教程，我高度推荐 <a href="http://google.github.io/styleguide/javaguide.html" target="_blank" rel="noopener">Google’s Java Style</a> 这个教程。写的最好的部分是 <a href="http://google.github.io/styleguide/javaguide.html#s6-programming-practices" target="_blank" rel="noopener">Programming Practices</a>。绝对值得一读。</p>
<h4 id="Javadoc"><a href="#Javadoc" class="headerlink" title="Javadoc"></a>Javadoc</h4><p>文档对对你代码的阅读着来说也很重要。这意味着你要给出<a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/ImmutableMap.Builder.html" target="_blank" rel="noopener">使用示例</a>，并且给出你的变量，方法和类清晰地描述。</p>
<p>这样做的必然结果是不要对不需要写文档的地方填写文档。如果你对一个参数的含义没什么可说的，或者它本身已经很明显是什么意思了，就不要为其写文档了。统一样板的文档比没有文档更加糟糕，这样会让读你代码的人误以为那就是文档。</p>
<h3 id="Streams"><a href="#Streams" class="headerlink" title="Streams"></a>Streams</h3><p><a href="http://www.java8.org/" target="_blank" rel="noopener">Java 8</a> 有很棒的 <a href="http://blog.hartveld.com/2013/03/jdk-8-33-stream-api.html" target="_blank" rel="noopener">stream</a> and lambda 语法。你可以像这样来写代码：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">final</span> List<span class="token operator">&lt;</span>String<span class="token operator">></span> filtered <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>s <span class="token operator">-</span><span class="token operator">></span> s<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"s"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>s <span class="token operator">-</span><span class="token operator">></span> s<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span>Collectors<span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>取代这样的写法:</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">final</span> List<span class="token operator">&lt;</span>String<span class="token operator">></span> filtered <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>String str <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"s"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        filtered<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>它让你可以写更多的流畅的代码，并且可读性更高。</p>
<h2 id="Deploying"><a href="#Deploying" class="headerlink" title="Deploying"></a>Deploying</h2><p>Java 的部署问题确实有点棘手。现如今有两种主流的方式：使用框架或者灵活性更高的内部研发的解决方案。</p>
<h3 id="Frameworks"><a href="#Frameworks" class="headerlink" title="Frameworks"></a>Frameworks</h3><p>由于 Java 的部署并不容易，所以使用框架还是很有帮助的。最好的两个框架是 <a href="https://dropwizard.github.io/dropwizard/" target="_blank" rel="noopener">Dropwizard</a> 和 <a href="http://projects.spring.io/spring-boot/" target="_blank" rel="noopener">Spring Boot</a>。<a href="https://www.playframework.com/" target="_blank" rel="noopener">Play 框架</a> 也可以被看作为一种部署框架。</p>
<p>这些框架都是尽力地降低你部署代码的壁垒。它们对 Java 新手或者想提高效率的人尤有帮助。单独的 JAR 包部署会比复杂的 WAR 包或者 EAR 包部署更简单一点。</p>
<p>然而，这些框架并没有你想象的那么灵活，如果你的项目的开发者选择的框架并不合适，你不得不迁移到手动配置更多的部署方案上来。</p>
<h3 id="Maven"><a href="#Maven" class="headerlink" title="Maven"></a>Maven</h3><p><strong>不错的替代工具</strong>: <a href="http://gradle.org/" target="_blank" rel="noopener">Gradle</a>.</p>
<p>Maven 仍然是构建，打包和测试的标准。有很多不错的替代工具，如 Gradle，但是他们同样都没有像 Maven 那样的适应性。如果你是 Maven 新手，你应该从<a href="http://books.sonatype.com/mvnex-book/reference/index.html" target="_blank" rel="noopener">Maven 实例</a>这里开始。</p>
<p>我喜欢用一个根 POM（Project Object Model，项目对象模型）来管理所有用到的外部依赖。它会像<a href="https://gist.github.com/cxxr/10787344" target="_blank" rel="noopener">这个样子</a>。这个根 POM 仅仅包含一个外部依赖，但是如果你的产品足够大，你将会有几十个外部依赖了。你的根 POM 应该像其他 Java 项目一样采用版本控制和发布的方式，有一个自己的项目。</p>
<p>如果你认为你的根 POM 每添加一个外部依赖都打上一个标签很麻烦，那你肯定没有遇到过为了排查依赖错误引起的问题，浪费一周的时间翻遍整个项目的情况。</p>
<p>你所有的 Maven 项目都应该包含你的根 POM，以及这些项目的所有版本信息。这样你会清除地了解到你们公司选择的每一个外部依赖的版本，以及所有正确的 Maven 插件。如果你要引入很多的外部依赖，它将会是这样子的：</p>
<pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.third.party<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>some-artifact<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span></code></pre>
<p>如果你想使用内部依赖，它应该被每一个单独项目的 <strong><dependencyManagement></strong> 部分来管理。否则那将会很难保持根 POM 的版本号是正常的。</p>
<h4 id="Dependency-Convergence"><a href="#Dependency-Convergence" class="headerlink" title="Dependency Convergence"></a>Dependency Convergence</h4><p>Java 最好的一方面就是拥有大量的第三方库可以做任何事。基本上每一个 API 或者工具包都有一个 Java SDK，可以很方便的用 Maven 引入。</p>
<p>并且这些第三方 Java 库本身依赖特定版本的其他的库。如果你引入足够多的库，你会发现有些库的版本是冲突的，像这样：</p>
<pre><code>Foo library depends on Bar library v1.0
Widget library depends on Bar library v0.9</code></pre><p>你的项目到底要引入哪一个版本呢？</p>
<p>如果你的项目依赖于不同版本的同一个库，使用 <a href="https://maven.apache.org/enforcer/enforcer-rules/dependencyConvergence.html" target="_blank" rel="noopener">Maven 依赖趋同插件</a>构建时将会报错。然后你有两个方案来解决这个冲突：</p>
<ol>
<li>在你的 <em>dependencyManagement</em> 部分明确地支出你所使用的 Bar 的版本号</li>
<li>在 FOO 或者 Widget 中排除对 Bar 的依赖。</li>
</ol>
<p>这两个方案到底选哪一个要看你面对的是什么情况：如果你想跟踪一个项目的版本，那么选择排除的方案是不错的。另一方面，如果你想明确地指出它，你可以选择一个版本，尽管你在需要更新其他依赖的时候也需要更新它。</p>
<h3 id="Continuous-Integration"><a href="#Continuous-Integration" class="headerlink" title="Continuous Integration"></a>Continuous Integration</h3><p>很明显，你需要某种形式的持续集成服务器来帮你不断构建你的快照版本和基于 git 标签构建。</p>
<p><a href="http://jenkins-ci.org/" target="_blank" rel="noopener">Jenkins</a> 和 <a href="https://travis-ci.org/" target="_blank" rel="noopener">Travis-CI</a> 就成了很自然的选择.</p>
<p>代码覆盖率非常有用，<a href="http://cobertura.github.io/cobertura/" target="_blank" rel="noopener">Cobertura</a> 就有 <a href="http://mojo.codehaus.org/cobertura-maven-plugin/usage.html" target="_blank" rel="noopener">一个很好的 Maven 插件</a><br><a href="http://mojo.codehaus.org/cobertura-maven-plugin/usage.html" target="_blank" rel="noopener">a good Maven plugin</a> 并且支持 CI。还有一些其他的支持 Java 的代码覆盖率工具，但是我只用过 Cobertura。</p>
<h3 id="Maven-repository"><a href="#Maven-repository" class="headerlink" title="Maven repository"></a>Maven repository</h3><p>你需要一个地方存储你生成的 JAR 包，WAR 包或者 EAR 包，因此，你需要一个仓库。</p>
<p>一般选择有 <a href="http://www.jfrog.com/" target="_blank" rel="noopener">Artifactory</a> 和 <a href="http://www.sonatype.com/nexus" target="_blank" rel="noopener">Nexus</a> 这两个。它们都可以用，但是它们都有着各自的优缺点。</p>
<p>你应该有自己的 Artifactory/Nexus 设备和<a href="http://www.jfrog.com/confluence/display/RTF/Configuring+Artifacts+Resolution" target="_blank" rel="noopener">镜像</a> 使你的依赖基于此。这样就不会由于上游的 Maven 库宕机而使你的构建崩溃了。</p>
<h3 id="Configuration-management"><a href="#Configuration-management" class="headerlink" title="Configuration management"></a>Configuration management</h3><p>现在，你的代码已经编译完了，你的仓库也跑起来了，最终你需要把你的代码从开发环境部署到生产环境了。到了这里，千万不要吝啬，因为将来很长一段时间，你会从这些自动化方式中尝到很多的甜头。</p>
<p><a href="https://www.chef.io/chef/" target="_blank" rel="noopener">Chef</a>，<a href="https://puppetlabs.com/" target="_blank" rel="noopener">Puppet</a>，和 <a href="http://www.ansible.com/home" target="_blank" rel="noopener">Ansible</a> 是很典型的选择。我曾经也写了一个叫 <a href="http://www.gosquadron.com" target="_blank" rel="noopener">Squadron</a> 的也可供选择，当然，我认为你应该仔细看看这个，因为它使用起来比其他的更为简单方便。</p>
<p>无论你选择了什么工具，不要忘了使你的部署实现自动化。</p>
<h2 id="Libraries"><a href="#Libraries" class="headerlink" title="Libraries"></a>Libraries</h2><p>对 Java 来说，拥有大量的扩展库也许是最大的特点了。下面这些一小部分的扩展库对大部分人来说很适用的。</p>
<h3 id="Missing-Features"><a href="#Missing-Features" class="headerlink" title="Missing Features"></a>Missing Features</h3><p>Java 标准库曾经作出过惊人的改进，但是现在来看，它仍然缺少一些关键的特性。</p>
<h4 id="Apache-Commons"><a href="#Apache-Commons" class="headerlink" title="Apache Commons"></a>Apache Commons</h4><p><a href="http://commons.apache.org/" target="_blank" rel="noopener">Apache Commons 项目</a> 拥有大量的有用的扩展库。</p>
<p><strong>Commons Codec</strong> 对 Base64 和 16 进制字符串来说有很多有用的编/解码方法。不要再浪费时间重写这些东西了。</p>
<p><strong>Commons Lang</strong> 有许多关于字符串的操作和创建，字符集和许多各种各样的实用的方法。</p>
<p><strong>Commons IO</strong> 拥有所有你能想到的关于文件操作的方法。有<br><a href="http://commons.apache.org/proper/commons-io/javadocs/api-release/org/apache/commons/io/FileUtils.html#copyDirectory(java.io.File,%20java.io.File)" target="_blank" rel="noopener">FileUtils.copyDirectory</a>，<a href="http://commons.apache.org/proper/commons-io/javadocs/api-release/org/apache/commons/io/FileUtils.html#writeStringToFile(java.io.File,%20java.lang.String)" target="_blank" rel="noopener">FileUtils.writeStringToFile</a>，<a href="http://commons.apache.org/proper/commons-io/javadocs/api-release/org/apache/commons/io/IOUtils.html#readLines(java.io.InputStream)" target="_blank" rel="noopener">IOUtils.readLines</a> 和更多实用的方法。</p>
<h4 id="Guava"><a href="#Guava" class="headerlink" title="Guava"></a>Guava</h4><p><a href="https://github.com/google/guava" target="_blank" rel="noopener">Guava</a> 是谷歌优秀的对 Java 标准库缺少的特性进行补充的扩展库。虽然这很难提炼总结出我有多喜欢这个库，但是我会尽力的。</p>
<p><strong>Cache</strong> 让你可以用很简单的方法，实现把网络访问，磁盘访问，缓存函数或者其他任何你想要缓存的内容，缓存到内存当中。你仅仅只需要实现 <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/cache/CacheBuilder.html" target="_blank" rel="noopener">CacheBuilder</a> 类并且告诉 Guava 怎么样构建你的缓存，一切就搞定了！</p>
<p><strong>Immutable</strong> 集合。它有许多如：<a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/ImmutableMap.html" target="_blank" rel="noopener">ImmutableMap</a>，<a href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/ImmutableList.html" target="_blank" rel="noopener">ImmutableList</a>，或者甚至 <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/ImmutableSortedMultiset.html" target="_blank" rel="noopener">ImmutableSortedMultiSet</a> 等不可变集合可以使用，如果你喜欢用这种风格的话。</p>
<p>我也喜欢用 Guava 的方式来写一些可变的集合：</p>
<pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// Instead of</span>
<span class="token keyword">final</span> Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Widget<span class="token operator">></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// You can use</span>
<span class="token keyword">final</span> Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Widget<span class="token operator">></span> map <span class="token operator">=</span> Maps<span class="token punctuation">.</span><span class="token function">newHashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>它还有一些静态类如 <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Lists.html" target="_blank" rel="noopener">Lists</a>，<a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Maps.html" target="_blank" rel="noopener">Maps</a>和<a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Sets.html" target="_blank" rel="noopener">Sets</a> 等。使用起来它们显得更整洁，并且可读性更强。</p>
<p>如果你坚持使用 Java 6 或者 7 的话，你可以使用 <a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Collections2.html" target="_blank" rel="noopener">Collections2</a> 这个类，它有一些像 filter 和 transform 这样的方法。能够让你没有 Java 8 的 Stream 的支持也能写出流畅的代码。</p>
<p>Guava 也可以做一些很简单的事情，比如 <strong>Joiner</strong> 类可以用来用分隔符把字符串拼接起来，并且可以用忽略的方式<a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/util/concurrent/Uninterruptibles.html" target="_blank" rel="noopener">来处理打断程序</a>的数据。</p>
<h4 id="Gson"><a href="#Gson" class="headerlink" title="Gson"></a>Gson</h4><p>谷歌的 <a href="https://github.com/google/gson" target="_blank" rel="noopener">Gson</a> 库是一个简单快速的 JSON 解析库。可以这样用：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">final</span> Gson gson <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Gson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">final</span> String json <span class="token operator">=</span> gson<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span>fooWidget<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">final</span> FooWidget newFooWidget <span class="token operator">=</span> gson<span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span>json<span class="token punctuation">,</span> FooWidget<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>这用起来真的很简单，很愉悦。<a href="https://sites.google.com/site/gson/gson-user-guide" target="_blank" rel="noopener">Gson 用户手册</a> 有很多的使用示例。</p>
<h4 id="Java-Tuples"><a href="#Java-Tuples" class="headerlink" title="Java Tuples"></a>Java Tuples</h4><p>Java 令我比较烦恼的问题之一 Java 标准库中没有内置对元组的支持。幸运的是，<a href="http://www.javatuples.org/" target="_blank" rel="noopener">Java tuples</a> 项目解决了这个问题。</p>
<p>它使用用起来很简单，很棒：</p>
<pre class=" language-java"><code class="language-java">Pair<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Integer<span class="token operator">></span> <span class="token function">func</span><span class="token punctuation">(</span>String input<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// something...</span>
    <span class="token keyword">return</span> Pair<span class="token punctuation">.</span><span class="token function">with</span><span class="token punctuation">(</span>stringResult<span class="token punctuation">,</span> intResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h4 id="Javaslang"><a href="#Javaslang" class="headerlink" title="Javaslang"></a>Javaslang</h4><p><a href="http://javaslang.com/" target="_blank" rel="noopener">Javaslang</a> 是一个函数式编程库，它被设计用来弥补本应该出现在 Java 8 中但缺失的一些特性。它有这样的一些特点：</p>
<ul>
<li>一个全新函数式集合库</li>
<li>紧密集成的元组功能</li>
<li>模式匹配</li>
<li>通过不可变性保证线程安全</li>
<li>饥汉式和懒汉式的数据类型</li>
<li>通过 Option 实现了 null 的安全性</li>
<li>通过 Try 更好的实现异常处理</li>
</ul>
<p>有一些 Java 库依赖于原始的 Java 集合类。它们通过以面向对象和被设计为可变的方式来保证和其他的类的兼容性。而 Javaslang 的集合的设计灵感来源于  Haskell, Clojure 和 Scala，是一个全新的飞跃。它们被设计为函数式风格并且遵循不可变性的设计风格。</p>
<p>像下面这样的代码就可以自动实现线程安全，并且不用 try-catch 语句处理异常：</p>
<pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// Success/Failure containing the result/exception</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> Try<span class="token operator">&lt;</span>User<span class="token operator">></span> <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token keyword">int</span> userId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Try<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> DB<span class="token punctuation">.</span><span class="token function">findUser</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">recover</span><span class="token punctuation">(</span>x <span class="token operator">-</span><span class="token operator">></span> Match<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">whenType</span><span class="token punctuation">(</span>RemoteException<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>e <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">whenType</span><span class="token punctuation">(</span>SQLException<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>e <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">// Thread-safe, reusable collections</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> List<span class="token operator">&lt;</span>String<span class="token operator">></span> <span class="token function">sayByeBye</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> List<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">"bye, "</span>bye<span class="token string">", "</span>collect<span class="token string">", "</span>mania"<span class="token punctuation">)</span>
               <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>String<span class="token operator">:</span><span class="token operator">:</span>toUpperCase<span class="token punctuation">)</span>
               <span class="token punctuation">.</span><span class="token function">intersperse</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h4 id="Joda-Time"><a href="#Joda-Time" class="headerlink" title="Joda-Time"></a>Joda-Time</h4><p><a href="http://www.joda.org/joda-time/" target="_blank" rel="noopener">Joda-Time</a> 是我用过的最简单的时间处理库。简单，直接，并且很容易测试。夫复何求？</p>
<p>因为 Java 8 已经有了自己的新的 <a href="http://www.oracle.com/technetwork/articles/java/jf14-date-time-2125367.html" target="_blank" rel="noopener">时间处理</a>库， 所以如果你还没有用 Java 8，你需要这一个库足矣。</p>
<h4 id="Lombok"><a href="#Lombok" class="headerlink" title="Lombok"></a>Lombok</h4><p><a href="https://projectlombok.org/" target="_blank" rel="noopener">Lombok</a> 是一个很有意思的库。它可以让你以注解的方式减少 Java 中糟糕的样板代码。</p>
<p>想为你的类的变量添加 setter 和 getter 方法吗？像这样：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Getter</span> <span class="token annotation punctuation">@Setter</span> <span class="token keyword">private</span> <span class="token keyword">int</span> var<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>现在你就可以这么用了：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">final</span> Foo foo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
foo<span class="token punctuation">.</span><span class="token function">setVar</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>这还有<a href="http://jnb.ociweb.com/jnb/jnbJan2010.html" target="_blank" rel="noopener">很多</a>例子。我在之前的产品中还没有用过 Lombok，但是现在我等不急了。</p>
<h4 id="Play-framework"><a href="#Play-framework" class="headerlink" title="Play framework"></a>Play framework</h4><p><strong>好的替代品</strong>: <a href="https://jersey.java.net/" target="_blank" rel="noopener">Jersey</a> 或者 <a href="http://sparkjava.com/" target="_blank" rel="noopener">Spark</a></p>
<p>在 Java 实现 RESTful web services 有两大主要阵营：<a href="https://en.wikipedia.org/wiki/Java_API_for_RESTful_Web_Services" target="_blank" rel="noopener">JAX-RS</a> 和其他。</p>
<p>JAX-RS 是传统的实现方式。你可以用像 <a href="https://jersey.java.net/" target="_blank" rel="noopener">Jersey</a> 这样的框架，以注解的方式来实现接口及其实现的结合。这样你就可以很容易的根据接口类来开发客户端。</p>
<p><a href="https://www.playframework.com/" target="_blank" rel="noopener">Play 框架</a> 基于 JVM 的 web services 实现和其他根本框架不同：它有一个路由文件，你写的类要和路由文件中的路由信息关联起来。Play 框架其实是一个<a href="https://www.playframework.com/documentation/2.3.x/Anatomy" target="_blank" rel="noopener">完整的 MVC 框架</a>，但是你可以很简单地仅仅使用它的 REST web services 部分的功能。</p>
<p>它同时支持 Java 和 Scala。虽然对重点支持的 Scala 稍有不足，但是对 Java 的支持还是很好用的。</p>
<p>如果你在 Python 中用过像 Flask 这样的微框架，你对 <a href="http://sparkjava.com/" target="_blank" rel="noopener">Spark</a> 肯定会很熟悉。它对 Java 8 的支持尤其的好。</p>
<h4 id="SLF4J"><a href="#SLF4J" class="headerlink" title="SLF4J"></a>SLF4J</h4><p>有很多 Java 日志解决方案。我最喜欢的是 <a href="http://www.slf4j.org/" target="_blank" rel="noopener">SLF4J</a>，因为它拥有非常棒的可插拔性，同时能够和很多的日志框架想结合。有没有做过同时使用 java.util.logging，JCL，和 log4j 的奇葩项目？SLF4J 就是为你而生。</p>
<p>这<a href="http://www.slf4j.org/manual.html" target="_blank" rel="noopener">两页手册</a>足够你可以开始入门使用 SLF4J 了。</p>
<h4 id="jOOQ"><a href="#jOOQ" class="headerlink" title="jOOQ"></a>jOOQ</h4><p>我不喜欢重量级的 ORM 框架，因为我喜欢 SQL。所以我写了很多 <a href="http://docs.spring.io/spring/docs/4.0.3.RELEASE/javadoc-api/org/springframework/jdbc/core/JdbcTemplate.html" target="_blank" rel="noopener">JDBC 模板</a>，但是很难去维护它。<a href="http://www.jooq.org/" target="_blank" rel="noopener">jOOQ</a> 是一个更好的解决方案。</p>
<p>它让你在 Java 中用类型安全的方式编写 SQL：</p>
<pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// Typesafely execute the SQL statement directly with jOOQ</span>
Result<span class="token operator">&lt;</span>Record3<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> String<span class="token punctuation">,</span> String<span class="token operator">>></span> result <span class="token operator">=</span> 
create<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>BOOK<span class="token punctuation">.</span>TITLE<span class="token punctuation">,</span> AUTHOR<span class="token punctuation">.</span>FIRST_NAME<span class="token punctuation">,</span> AUTHOR<span class="token punctuation">.</span>LAST_NAME<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>BOOK<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>AUTHOR<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span>BOOK<span class="token punctuation">.</span>AUTHOR_ID<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>AUTHOR<span class="token punctuation">.</span>ID<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>BOOK<span class="token punctuation">.</span>PUBLISHED_IN<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token number">1948</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>使用 jOOQ 和 <a href="http://www.javapractices.com/topic/TopicAction.do?Id=66" target="_blank" rel="noopener">DAO</a> 的模式让你的数据库访问变得轻而易举。</p>
<h3 id="Testing"><a href="#Testing" class="headerlink" title="Testing"></a>Testing</h3><p>测试是软件的关键环节。下面这些软件包能够让你更容易地测试。</p>
<h4 id="jUnit-4"><a href="#jUnit-4" class="headerlink" title="jUnit 4"></a>jUnit 4</h4><p><strong>好的替代品</strong>：<a href="http://testng.org" target="_blank" rel="noopener">TestNG</a>.</p>
<p><a href="http://junit.org/" target="_blank" rel="noopener">jUnit</a> 就无需多言了。它是 Java 单元测试中的标准工具。</p>
<p>但是很可能你使用的 jUnit 并没有发挥它的全部潜力。jUnit 支持<a href="https://github.com/junit-team/junit/wiki/Parameterized-tests" target="_blank" rel="noopener">参数化测试</a>，<a href="https://github.com/junit-team/junit/wiki/Rules" target="_blank" rel="noopener">规则化</a>测试，<a href="https://github.com/junit-team/junit/wiki/Theories" target="_blank" rel="noopener">theories</a> 可以随机测试特定代码，还有 <a href="https://github.com/junit-team/junit/wiki/Assumptions-with-assume" target="_blank" rel="noopener">assumptions</a>，可以让你少写很多样板代码。</p>
<h4 id="jMock"><a href="#jMock" class="headerlink" title="jMock"></a>jMock</h4><p>如果你完成了依赖注入，这是它的回报：可以 mock 出有副作用（比如和 REST 服务器交互）的代码，并且可以断言调用这段代码的行为。</p>
<p><a href="http://www.jmock.org/" target="_blank" rel="noopener">jMock</a> 是标准的 Java mock 工具。像这样使用：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FooWidgetTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> Mockery context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mockery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">basicTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">final</span> FooWidgetDependency dep <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span>FooWidgetDependency<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        context<span class="token punctuation">.</span><span class="token function">checking</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Expectations</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>
            <span class="token function">oneOf</span><span class="token punctuation">(</span>dep<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token function">with</span><span class="token punctuation">(</span><span class="token function">any</span><span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">atLeast</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>dep<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">optionalCall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">final</span> FooWidget foo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FooWidget</span><span class="token punctuation">(</span>dep<span class="token punctuation">)</span><span class="token punctuation">;</span>

        Assert<span class="token punctuation">.</span><span class="token function">assertTrue</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span><span class="token function">doThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">assertIsSatisfied</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>这段代码通过 jMock 建立了一个 <em>FooWidgetDependency*，然后添加你所期望结果的条件。我们期望 *dep</em> 的 <em>call</em> 方法会被以一个字符串为参数的形式调用，并且会被调用 0 次或者多次。</p>
<p>如果你想一遍又一遍地设置相同的依赖，你应该把它放到 <a href="https://github.com/junit-team/junit/wiki/Test-fixtures" target="_blank" rel="noopener">test fixture</a> 中，并且把<em>assertIsSatisfied</em> 放在以 <em>@After</em> 注解的 fixture 中。</p>
<h4 id="AssertJ"><a href="#AssertJ" class="headerlink" title="AssertJ"></a>AssertJ</h4><p>你曾经用 jUnit 干过这个吗？</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">final</span> List<span class="token operator">&lt;</span>String<span class="token operator">></span> result <span class="token operator">=</span> some<span class="token punctuation">.</span><span class="token function">testMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">assertTrue</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"some result"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">assertTrue</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"some other result"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">assertFalse</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"shouldn't be here"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>这是很恶心的样板代码。<a href="http://joel-costigliola.github.io/assertj/index.html" target="_blank" rel="noopener">AssertJ</a> 可以解决这个问题。你可以把相同的代码转换成这个样子：</p>
<pre class=" language-java"><code class="language-java"><span class="token function">assertThat</span><span class="token punctuation">(</span>some<span class="token punctuation">.</span><span class="token function">testMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasSize</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
                             <span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"some result"</span><span class="token punctuation">,</span> <span class="token string">"some other result"</span><span class="token punctuation">)</span>
                             <span class="token punctuation">.</span><span class="token function">doesNotContain</span><span class="token punctuation">(</span><span class="token string">"shouldn't be here"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>这样的流畅接口让你的测试更具有可读性。你还想咋地？</p>
<h2 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h2><h3 id="IntelliJ-IDEA"><a href="#IntelliJ-IDEA" class="headerlink" title="IntelliJ IDEA"></a>IntelliJ IDEA</h3><p><strong>好的替代品</strong>: <a href="https://www.eclipse.org/" target="_blank" rel="noopener">Eclipse</a> 和 <a href="https://netbeans.org/" target="_blank" rel="noopener">Netbeans</a></p>
<p>Java 最好的 IDE 是 <a href="http://www.jetbrains.com/idea/" target="_blank" rel="noopener">IntelliJ IDEA</a>。它有大量的牛逼的特性，它是真正的能让 Java 用来像不戴套做爱那么爽的工具。自动完成功能超棒，<a href="http://i.imgur.com/92ztcCd.png" target="_blank" rel="noopener">代码检查功能也是顶尖的</a>，重构工具那是相当有帮助。</p>
<p>免费的社区版对我来说已经足够好了，但是它的旗舰版加载了更多的牛逼的特性，如数据库工具，Spring 框架的支持和对 Chronon 的支持。</p>
<h4 id="Chronon"><a href="#Chronon" class="headerlink" title="Chronon"></a>Chronon</h4><p>我最喜欢 GDB 7 的特性之一就是调试的时候能够按照时间跟踪回来。当你拥有了旗舰版的 IntelliJ，你可以通过安装 <a href="http://blog.jetbrains.com/idea/2014/03/try-chronon-debugger-with-intellij-idea-13-1-eap/" target="_blank" rel="noopener">Chronon IntelliJ 插件</a>实现。</p>
<p>你可以获取到变量的变化历史，后退，方法的历史以及更多的信息。如果你是第一次用会觉得有点怪，但是它真的能够帮你解决很复杂的 bug，诸如海森堡类的 bug。</p>
<h3 id="JRebel"><a href="#JRebel" class="headerlink" title="JRebel"></a>JRebel</h3><p><strong>好的替代品</strong>: <a href="https://github.com/dcevm/dcevm" target="_blank" rel="noopener">DCEVM</a></p>
<p>持续集成往往以软件即服务为产品目标。想象一下如果你不用等待代码构建完成而能实时看到代码的变化会是怎样？</p>
<p>这就是 <a href="http://zeroturnaround.com/software/jrebel/" target="_blank" rel="noopener">JRebel</a> 所做的。一旦你将你的服务器和你的 JReble 以 hook 方式连接，你就可以从服务器看到实时变化。当你想快速试验的时候它能为你节省大量的时间。</p>
<h3 id="The-Checker-Framework"><a href="#The-Checker-Framework" class="headerlink" title="The Checker Framework"></a>The Checker Framework</h3><p>Java 的类型系统很差劲。它不能够区分正常的字符串和正则表达式字符串，更不用说<a href="https://en.wikipedia.org/wiki/Taint_checking" target="_blank" rel="noopener">坏点检查</a>了。不过 <a href="http://types.cs.washington.edu/checker-framework/" target="_blank" rel="noopener">Checker Framework</a> 可以完成这个功能并且能够实现更多的东西。</p>
<p>它使用像 <em>@Nullable</em> 这样的注解来检查类型。你甚至可以使用<a href="http://types.cs.washington.edu/checker-framework/tutorial/webpages/encryption-checker-cmd.html" target="_blank" rel="noopener">自定义注解</a>来实现静态分析，甚至更强大的功能。</p>
<h3 id="Code-Quality"><a href="#Code-Quality" class="headerlink" title="Code Quality"></a>Code Quality</h3><p>即使遵循着最佳实践的原则，即使是最好的开发者，也都会犯错误。这有很多工具，你可以使用它们验证你的代码从而检查代码是否有问题。下面是选出的最流行的一部分工具。很多这些工具都可以和流行的 IDE 如 Eclipse 或者 IntelliJ 集成，可以让你更快地发现代码中的错误。</p>
<ul>
<li><strong><a href="http://checkstyle.sourceforge.net/" target="_blank" rel="noopener" title="Checkstyle">Checkstyle</a></strong>：一个静态代码分析工具，它主要着力于保证你的代码符合代码标准。检查规则在一个 XML 文件中定义，你可以把它检入你的版本控制工具，和你的代码放在一起。</li>
<li><strong><a href="http://findbugs.sourceforge.net/" target="_blank" rel="noopener" title="FindBugs">FindBugs</a></strong>：主要集中于发现你的代码中可能导致产生 bug 或者错误的部分。虽然作为独立的进程运行，但是对流行的 IDE 和构建工具的支持也很好。</li>
<li><strong><a href="https://pmd.github.io/" target="_blank" rel="noopener" title="PMD">PMD</a></strong>：和 FindBugs 很相似，PMD 着力于发现你代码中的错误和整理的你的代码。你可以把针对你的代码的检查规则控制在 XML 文件中，和你的代码放在一块儿提交。</li>
<li><strong><a href="http://www.sonarqube.org/" target="_blank" rel="noopener" title="SonarQube">SonarQube</a></strong>：和前面所述的工具不同，它是在本地运行的，SonarQube 启动一个服务器，你把你代码提交到这个服务器来进行分析。它提供了 web 界面，你可以看到你的代码的健康状况信息，如不好的做法，潜在的 bug，测试覆盖率百分比，和你写代码的<a href="https://en.wikipedia.org/wiki/Technical_debt" target="_blank" rel="noopener" title="Technical Debt on Wikipedia">技术水平</a></li>
</ul>
<p>除了在开发工程中使用这些工具，把它们用在你的构建阶段往往也是一个不错的想法。它可以和想 Maven 或者 Gradle 这样的构建工具绑定到一起，也可以和持续集成工具绑定使用。</p>
<h3 id="Eclipse-Memory-Analyzer"><a href="#Eclipse-Memory-Analyzer" class="headerlink" title="Eclipse Memory Analyzer"></a>Eclipse Memory Analyzer</h3><p>即使在 Java 中内存泄露也时有发生。幸运的是，我们有一些工具就是为此而生。<a href="http://www.eclipse.org/mat/" target="_blank" rel="noopener">Eclipse Memory Analyzer</a> 是我用过的最好用的解决内存泄露问题的工具。它能够获取到堆栈信息让你查阅，去发现问题所在。</p>
<p>有几种方法可以获取到 JVM 进程的堆栈信息，但是我用 <a href="http://docs.oracle.com/javase/7/docs/technotes/tools/share/jmap.html" target="_blank" rel="noopener">jmap</a> 工具实现：</p>
<pre class=" language-bash"><code class="language-bash">$ jmap -dump:live,format<span class="token operator">=</span>b,file<span class="token operator">=</span>heapdump.hprof -F 8152
Attaching to process ID 8152, please wait<span class="token punctuation">..</span>.
Debugger attached successfully.
Server compiler detected.
JVM version is 23.25-b01
Dumping heap to heapdump.hprof <span class="token punctuation">..</span>.
<span class="token punctuation">..</span>. snip <span class="token punctuation">..</span>.
Heap dump <span class="token function">file</span> created</code></pre>
<p>然后你可以用内存分析器打开 <em>heapdump.hprof</em> 文件，快看看到底是怎么回事。</p>
<h2 id="Resources"><a href="#Resources" class="headerlink" title="Resources"></a>Resources</h2><p>这些资源能够帮你成为 Java 大牛。</p>
<h3 id="Books"><a href="#Books" class="headerlink" title="Books"></a>Books</h3><ul>
<li><a href="http://www.amazon.com/Effective-Java-Edition-Joshua-Bloch/dp/0321356683" target="_blank" rel="noopener">Effective Java</a></li>
<li><a href="http://www.amazon.com/Java-Concurrency-Practice-Brian-Goetz/dp/0321349601" target="_blank" rel="noopener">Java Concurrency in Practice</a></li>
<li><a href="http://www.amazon.com/Clean-Code-Handbook-Software-Craftsmanship/dp/0132350882/" target="_blank" rel="noopener">Clean Code</a></li>
</ul>
<h3 id="Podcasts"><a href="#Podcasts" class="headerlink" title="Podcasts"></a>Podcasts</h3><ul>
<li><a href="http://www.javaposse.com/" target="_blank" rel="noopener">The Java Posse</a> (<em>discontinued</em>)</li>
<li><a href="http://virtualjug.com/" target="_blank" rel="noopener">vJUG</a></li>
<li><a href="https://lescastcodeurs.com/" target="_blank" rel="noopener">Les Cast Codeurs</a> (<em>French</em>)</li>
<li><a href="http://www.javapubhouse.com/" target="_blank" rel="noopener">Java Pub House</a></li>
<li><a href="http://www.javaoffheap.com/" target="_blank" rel="noopener">Java Off Heap</a></li>
<li><a href="http://www.enterprisejavanews.com" target="_blank" rel="noopener">Enterprise Java Newscast</a></li>
</ul>
<h3 id="Videos"><a href="#Videos" class="headerlink" title="Videos"></a>Videos</h3><ul>
<li><a href="https://www.youtube.com/watch?v=V1vQf4qyMXg" target="_blank" rel="noopener">Effective Java - Still Effective After All These Years</a></li>
<li><a href="http://www.infoq.com/" target="_blank" rel="noopener">InfoQ</a> - see especially <a href="http://www.infoq.com/java/presentations/" target="_blank" rel="noopener">presentations</a> and <a href="http://www.infoq.com/java/interviews/" target="_blank" rel="noopener">interviews</a></li>
<li><a href="https://www.parleys.com/" target="_blank" rel="noopener">Parleys</a></li>
</ul>

            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://findhappytime.github.io" rel="external nofollow noreferrer">张曙</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://findhappytime.github.io/2017/09/06/2017-09-06-better-java/">https://findhappytime.github.io/2017/09/06/2017-09-06-better-java/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="https://findhappytime.github.io" target="_blank">张曙</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/%E7%AC%94%E8%AE%B0/">
                                    <span class="chip bg-color">笔记</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.png" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>
            
        </div>
    </div>

    
        <link rel="stylesheet" href="/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: '469d2f9834bd70260b99',
        clientSecret: '548992f248078f76b17fdeb4f71cd2f65b3b0906',
        repo: 'findhappytime.github.io',
        owner: 'findhappytime',
        admin: ["findhappytime"],
        id: '2017-09-06T19-00-00',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>
    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2018/04/28/09-fang-fa-lun/2018-04-28-ru-he-gei-bo-ke-wen-zhang-fen-lei/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/10.jpg" class="responsive-img" alt="如何给博客文章分类">
                        
                        <span class="card-title">如何给博客文章分类</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            如何给博客文章分类
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2018-04-28
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E7%90%86%E8%AE%BA/" class="post-category">
                                    理论
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E5%8E%9F%E5%88%9B/">
                        <span class="chip bg-color">原创</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2017/08/15/2017-08-15-tu-jie-http-yue-du-bi-ji/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/12.jpg" class="responsive-img" alt="图解HTTP">
                        
                        <span class="card-title">图解HTTP</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            图解HTTP
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2017-08-15
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/" class="post-category">
                                    阅读笔记
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E7%AC%94%E8%AE%B0/">
                        <span class="chip bg-color">笔记</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>

    
<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>

    

</main>



    <footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">年份</span>
            <a href="https://findhappytime.github.io" target="_blank">Zhang Shu</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">15.4k</span>&nbsp;字
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <span id="sitetime">载入运行时间...</span>
            <script>
                function siteTime() {
                    window.setTimeout("siteTime()", 1000);
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2019";
                    var startMonth = "11";
                    var startDate = "1";
                    var startHour = "0";
                    var startMinute = "0";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffDays + " 天 " + diffHours +
                            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffYears + " 年 " + diffDays +
                            " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/findhappytime/findhappytime.github.io" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:findhappytime@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->


    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    

    

    
    <script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async="async"></script>
    
    
    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
